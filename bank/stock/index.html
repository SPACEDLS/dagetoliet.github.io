<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大哥国际银行-股票详情</title>
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/element-plus"></script>
    <style>
        :root {
            --gold-color: #d4af37;
            --gold-light: #f4e4bc;
        }
        body {
            margin: 0;
            background-color: #1a1a1a; /* 深色背景衬托金色 */
            font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
        }
        #app {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        /* 顶部导航 */
        .header {
            background-color: var(--gold-color);
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }
        /* 股票实时数据 */
        .stock-info {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        .price {
            font-size: 36px;
            font-weight: bold;
            color: #e63946; /* 涨幅颜色 */
        }
        .trend {
            font-size: 14px;
            margin-top: 5px;
        }
        /* 伪股票图占位 */
        .chart-container {
            flex: 1;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .fake-chart {
            width: 100%;
            height: 250px;
            background: linear-gradient(180deg, var(--gold-light) 0%, #ffffff 100%);
            border: 1px dashed var(--gold-color);
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--gold-color);
            border-radius: 8px;
        }
        /* 底部按钮 */
        .footer {
            padding: 20px;
            text-align: center;
        }
        .buy-btn {
            width: 100%;
            height: 50px;
            font-size: 18px;
            background-color: var(--gold-color) !important;
            border-color: var(--gold-color) !important;
            color: #fff !important;
        }
        /* 修改Element弹窗金色主题 */
        .el-button--primary {
            --el-button-bg-color: var(--gold-color);
            --el-button-border-color: var(--gold-color);
            --el-button-hover-bg-color: #b8952d;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
          大哥国际银行<br>
            股票明细 {{ stockData.stockName }}({{ stockData.symbol }})
        </div>

        <div class="stock-info" v-if="stockData.currentPrice">
            <div class="price">¥ {{ stockData.currentPrice }}</div>
            <div class="trend" :style="{ color: stockData.status === '上涨' ? '#e63946' : '#2a9d8f' }">
                <span>{{ stockData.changeAmount }}</span> 
                <span style="margin-left: 10px;">{{ stockData.changePercent }}</span>
                <span style="margin-left: 10px;">{{ stockData.status }}</span>
            </div>
        </div>

        <div class="chart-container">
            <div v-loading="loading" class="fake-chart">
                    </div>
        </div>

        <div class="footer">
            <el-button class="buy-btn" @click="dialogVisible = true">投股</el-button>
        </div>

        <el-dialog
            v-model="dialogVisible"
            title="股票买入"
            width="80%"
            align-center
        >
            <el-form label-position="top">
                <el-form-item label="请输入买入金额">
                    <el-input 
                        v-model="buyAmount" 
                        placeholder="请输入金额" 
                        clearable
                        type="text"
                    ></el-input>
                </el-form-item>
            </el-form>
            <template #footer>
                <span class="dialog-footer">
                    <el-button @click="dialogVisible = false">取消</el-button>
                    <el-button type="primary" @click="handleBuy">
                        提交
                    </el-button>
                </span>
            </template>
        </el-dialog>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;
        const { ElMessage } = ElementPlus;

        const app = createApp({
            setup() {
              const loading = ref(true)
                const stockData = ref({});
                const dialogVisible = ref(false);
                const buyAmount = ref('');

                // 模拟从外部 gp.json 获取数据
                const fetchStockData = async () => {
                    try {
                        const response = await fetch('./gp.json');
                        if (!response.ok) throw new Error('网络请求失败');
                    
                        stockData.ref = await response.json();
                        stockData.value = stockData.ref;
                 loading.value = false;
                    } catch (error) {
                        console.error('获取数据失败:', error);
                                 ElMessage.error('数据获取失败');
               
                        // 兜底数据
                        stockData.value = {
                            stockName: "大哥国际集团",
                            symbol: "dage666666",
                            currentPrice: "188.88",
                            changeAmount: "+12.50",
                            changePercent: "+7.08%",
                            status: "上涨"
                        };
                    }
                };

                // 处理买入逻辑
                const handleBuy = () => {
                    const val = buyAmount.value.trim();
                    
                    // 校验：不能为空且必须是数字
                    if (val === '') {
                        ElMessage.error('金额不能为空');
                        return;
                    }
                    if (isNaN(val) || parseFloat(val) <= 0) {
                        ElMessage.error('请输入有效的数字金额');
                        return;
                    }

                    // 验证通过
                    ElMessage({
                        message: '买入成功！',
                        type: 'success',
                    });
                    dialogVisible.value = false;
                    buyAmount.value = ''; // 清空输入
                };

                onMounted(() => {
                    fetchStockData();
                });

                return {
                    stockData,
                    dialogVisible,
                    buyAmount,
                    handleBuy,
                    loading
                };
            }
        });

        app.use(ElementPlus);
        app.mount('#app');
    </script>
</body>
</html>